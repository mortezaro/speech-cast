<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Optimizing Speech Language Models for Acoustic Consistency – Demo</title>
  <style>
    :root{
      --blue:#5a9fd6;
      --text:#222; /* softer black */
      --subtle:#444; /* for secondary text */
      --border:#bbb;
      --bg:#fff;
    }

    html,body{
      margin:0;
      padding:0;
      background:var(--bg);
      color:var(--text);
      font-family:Inter, Helvetica, Arial, sans-serif;
    }

    .page{
      max-width:1100px;
      margin:0 auto;
      padding:48px 24px 72px;
    }

    .masthead{
      display:grid;
      grid-template-columns:1fr auto;
      gap:16px;
      align-items:end;
      margin-bottom:22px
    }
    .title{
      font-size:clamp(28px,4.5vw,44px);
      line-height:1.08;
      font-weight:800;
      letter-spacing:0.2px;
      margin:0;
      color:#111; /* slightly darker for title */
    }
    .authors{font-size:clamp(14px,1.6vw,16px);opacity:.9;margin-top:6px}
    .affil{font-size:clamp(13px,1.4vw,15px);opacity:.8;margin-top:2px}

    .links{display:flex;gap:10px;align-items:center}
    .btn{
      --h:36px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      height:var(--h);
      padding:0 14px;
      border:2px solid var(--subtle);
      border-radius:999px;
      text-decoration:none;
      color:var(--subtle);
      font-weight:700;
      font-size:14px;
      letter-spacing:.02em;
      background:#fff;
      transition:all 0.15s ease;
    }
    .btn:hover{transform:translateY(-1px);border-color:var(--blue);color:var(--blue);}
    .btn.blue{
      border-color:var(--blue);
      color:#fff;
      background:var(--blue);
    }

    /* Light accent bar */
    .accent{
      height:6px;
      background:repeating-linear-gradient(90deg,#d8ebfa 0 24px,#ccc 24px 48px);
      margin:18px 0 28px;
      border-radius:3px;
    }

    /* Abstract box */
    .abstract{
      background:#fff;
      border:1px solid #e5e5e5;
      border-radius:10px;
      padding:16px 18px;
      margin:0 0 22px;
      box-shadow:0 1px 3px rgba(0,0,0,0.05);
    }
    .abstract p{
      margin:0;
      font-size:15px;
      line-height:1.65;
      color:var(--text);
    }

    figure{margin:0;background:#fff;border:none;padding:0}
    figure img{display:block;width:70%;height:auto;border-radius:6px}
    figcaption{font-size:13px;margin-top:8px;color:var(--subtle)}

    .samples{margin-top:26px}
    .samples h2{font-size:20px;margin:0 0 10px;color:var(--text)}
    .grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px;align-items:center}
    .grid .hdr{
      font-size:14px;
      letter-spacing:.04em;
      text-transform:uppercase;
      color:var(--blue);
      border-bottom:2px solid var(--blue);
      padding-bottom:6px;
      text-align:center
    }

    .audio{
      position:relative;
      height:28px;
      display:flex;
      align-items:center;
      cursor:pointer
    }
    .audio .bar{
      position:relative;
      flex:1;
      height:4px;
      background:#e8f2fb;
      border-radius:3px;
      overflow:hidden
    }
    .audio .fill{
      position:absolute;
      left:0;
      top:0;
      height:100%;
      width:0;
      background:var(--blue)
    }
    .audio .knob{
      position:absolute;
      top:50%;
      transform:translate(-50%,-50%);
      width:0;
      height:0;
      border-left:7px solid var(--blue);
      border-top:6px solid transparent;
      border-bottom:6px solid transparent;
    }
    .audio.playing .knob{border-left-color:var(--subtle);}
    .audio .time{font-size:12px;margin-left:8px;min-width:70px;text-align:right;color:var(--subtle)}
    .play-icon{margin-right:8px;font-size:16px;color:var(--blue)}

    footer{
      margin-top:42px;
      padding-top:12px;
      border-top:1px solid #ddd;
      font-size:13px;
      color:var(--subtle)
    }

    @media (max-width:760px){
      figure img{width:100%}
      .grid{grid-template-columns:1fr;}
      .grid .hdr{border-bottom:none}
      .row{display:block;border:1px solid #eee;border-radius:10px;padding:10px;margin-bottom:12px}
      .masthead{grid-template-columns:1fr}
      .links{justify-content:flex-start}
    }
  </style>
</head>
<body>
  <div class="page">
    <header class="masthead" role="banner">
      <div>
        <h1 class="title">Optimizing Speech Language Models for Acoustic Consistency</h1>
        <div class="authors">Authors: Morteza Rohanian, Michael Krauthammer</div>
        <div class="affil">University of Zurich, Zurich, Switzerland</div>
      </div>
      <nav class="links" aria-label="Links">
        <a class="btn" id="paperLink" href="#" target="_blank" rel="noopener">Paper</a>
        <a class="btn blue" id="hfLink" href="#" target="_blank" rel="noopener">Hugging Face</a>
      </nav>
    </header>

    <div class="accent"></div>

    <main>
      <!-- Abstract -->
      <section class="abstract">
        <p>
          We study speech language models that incorporate semantic initialization and planning losses to achieve robust and consistent generation. Our approach initializes speech tokens with self-supervised features, applies a light alignment loss, and trains with thinning and auxiliary objectives that target robustness and content planning. We train three models: a 0.7B speech-only model, a 1.0B speech-only model, and a 1.0B interleaved model with both text and speech. Acoustic studies show that the speech-only models achieve the highest consistency across speaker, gender, sentiment, room, and background factors, surpassing larger systems. Interleaving improves lexical and syntactic probes and semantic–acoustic alignment but reduces consistency. Linear probes show that our initialization biases the model toward content structure while trading off prosody detail. These results show that LM-side design and training mix control the balance between acoustic stability and semantic grounding without changes to the tokenizer or runtime architecture.
        </p>
      </section>

      <figure>
        <img src="assets/method_overview.png" alt="Method overview figure" />
        <figcaption>Figure 1: Method overview.</figcaption>
      </figure>

      <section class="samples">
        <h2>Generation Examples</h2>
        <div class="grid" id="samples-grid" role="table">
          <div class="hdr">Prompt</div>
          <div class="hdr">Resynthesis</div>
          <div class="hdr">Generated</div>
        </div>
      </section>
    </main>

    <footer>
      <div>Keyboard controls: Enter/Space to play or pause, Left/Right to seek.</div>
    </footer>
  </div>

  <script>
    document.getElementById('paperLink').href = 'https://arxiv.org/abs/2509.26276';
    document.getElementById('hfLink').href = 'https://huggingface.co/KrauthammerLab/cast-0.7b-s2s';

    const SAMPLE_ROWS = [
      { prompt: 'audio/1.wav',  resyn: 'audio/1-2.wav',  gen: 'audio/1-3.wav' },
      { prompt: 'audio/2.wav',  resyn: 'audio/2-2.wav',  gen: 'audio/2-3.wav' },
      { prompt: 'audio/3.wav',  resyn: 'audio/3-2.wav',  gen: 'audio/3-3.wav' },
      { prompt: 'audio/4.wav',  resyn: 'audio/4-2.wav',  gen: 'audio/4-3.wav' },
      { prompt: 'audio/5.wav',  resyn: 'audio/5-2.wav',  gen: 'audio/5-3.wav' },
      { prompt: 'audio/6.wav',  resyn: 'audio/6-2.wav',  gen: 'audio/6-3.wav' },
      { prompt: 'audio/7.wav',  resyn: 'audio/7-2.wav',  gen: 'audio/7-3.wav' },
      { prompt: 'audio/8.wav',  resyn: 'audio/8-2.wav',  gen: 'audio/8-3.wav' },
    ];

    const PLAYERS = new Set();
    function stopOthers(me){ for(const p of PLAYERS){ if(p !== me){ p.audio.pause(); } } }

    function createAudioLine(src, label){
      const wrap = document.createElement('div');
      wrap.className = 'audio';
      wrap.setAttribute('role','button');
      wrap.setAttribute('aria-label', label);
      wrap.tabIndex = 0;

      const playIcon = document.createElement('span');
      playIcon.className = 'play-icon';
      playIcon.textContent = '▶';

      const bar = document.createElement('div');
      bar.className = 'bar';
      const fill = document.createElement('div');
      fill.className = 'fill';
      const knob = document.createElement('div');
      knob.className = 'knob';
      bar.appendChild(fill); bar.appendChild(knob);

      const time = document.createElement('div');
      time.className = 'time';
      time.textContent = '0:00';

      wrap.appendChild(playIcon);
      wrap.appendChild(bar);
      wrap.appendChild(time);

      const audio = new Audio(src);
      audio.preload = 'metadata';

      function fmt(t){
        if(!isFinite(t)) return '0:00';
        const m = Math.floor(t/60);
        const s = Math.floor(t%60).toString().padStart(2,'0');
        return m + ':' + s;
      }
      audio.addEventListener('loadedmetadata', ()=>{ time.textContent = '0:00 / ' + fmt(audio.duration); });
      audio.addEventListener('timeupdate', ()=>{
        const p = audio.currentTime / (audio.duration || 1);
        fill.style.width = (p*100).toFixed(2) + '%';
        knob.style.left = (p*100).toFixed(2) + '%';
        time.textContent = fmt(audio.currentTime) + ' / ' + fmt(audio.duration);
      });
      audio.addEventListener('play', ()=>{ wrap.classList.add('playing'); stopOthers(player); });
      audio.addEventListener('pause', ()=>{ wrap.classList.remove('playing'); });
      audio.addEventListener('ended', ()=>{ audio.currentTime = 0; audio.pause(); });

      function toggle(){ if(audio.paused){ audio.play(); } else { audio.pause(); } }

      wrap.addEventListener('click', (e)=>{
        const rect = bar.getBoundingClientRect();
        if(e.target===bar||e.target===fill||e.target===knob){
          const p = (e.clientX-rect.left)/rect.width;
          if(isFinite(audio.duration)) audio.currentTime = Math.max(0, Math.min(audio.duration, p*audio.duration));
          if(audio.paused) audio.play();
        } else { toggle(); }
      });

      wrap.addEventListener('keydown', (e)=>{
        if(e.code==='Space'||e.code==='Enter'){ e.preventDefault(); toggle(); }
      });

      const player = {wrap,audio};
      PLAYERS.add(player);
      return wrap;
    }

    function addRow(grid, item){
      const c1 = document.createElement('div'); c1.appendChild(createAudioLine(item.prompt, 'Prompt'));
      const c2 = document.createElement('div'); c2.appendChild(createAudioLine(item.resyn, 'Resynthesis'));
      const c3 = document.createElement('div'); c3.appendChild(createAudioLine(item.gen, 'Generated'));
      grid.appendChild(c1); grid.appendChild(c2); grid.appendChild(c3);
    }

    const gridEl = document.getElementById('samples-grid');
    SAMPLE_ROWS.forEach(item=>addRow(gridEl, item));
  </script>
</body>
</html>
